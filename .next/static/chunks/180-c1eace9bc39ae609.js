"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[180],{640:(e,t,r)=>{r.d(t,{G6:()=>c,vr:()=>n});var o=r(3579);r(1890);let a=(0,o.createClientComponentClient)();async function n(e,t){try{let{data:{user:r}}=await a.auth.getUser();if(!r)throw Error("User not authenticated");let o={...t,updated_at:new Date().toISOString()};o.expected_completion_date&&(o.end_date=o.expected_completion_date,delete o.expected_completion_date),delete o.actual_completion_date,console.log("[updateProject] Update payload:",o);let{data:n,error:c}=await a.from("projects").update(o).eq("id",e).eq("user_id",r.id).select().single();if(c)throw console.error("[updateProject] Supabase error:",c),c;return{id:n.id,user_id:n.user_id,name:n.name,description:n.description||"",project_type:n.project_type,location:n.location,address:n.address||"",city:n.city||"",region:n.region||"",status:n.status,priority:n.priority,start_date:n.start_date,expected_completion_date:n.end_date,budget:n.budget||0,actual_cost:n.actual_cost||0,currency:n.currency||"SAR",progress_percentage:n.progress_percentage||0,is_active:n.is_active,created_at:n.created_at,updated_at:n.updated_at}}catch(e){throw console.error("Error updating project:",e),e}}async function c(e){var t,r,o;try{console.log("\uD83D\uDD0D [getProjectById] Starting fetch for projectId:",e);let{data:{user:r}}=await a.auth.getUser();if(console.log("\uD83D\uDC64 [getProjectById] Auth user:",r?{id:r.id,email:r.email}:"null"),!r)throw console.error("❌ [getProjectById] User not authenticated"),Error("User not authenticated");console.log("\uD83D\uDD0D [getProjectById] Querying project with filters:",{projectId:e,userId:r.id});let{data:o,error:n}=await a.from("projects").select("id, name, user_id").eq("user_id",r.id);console.log("\uD83D\uDCCA [getProjectById] User has total projects:",(null==o?void 0:o.length)||0),o&&o.length>0&&console.log("\uD83D\uDCCB [getProjectById] User's project IDs:",o.map(e=>({id:e.id,name:e.name})));let{data:c,error:s}=await a.from("projects").select("\n        id, user_id, name, description, project_type, location, \n        address, status, start_date, \n        budget, is_active, created_at, updated_at\n        ").eq("id",e).eq("user_id",r.id).single();if(console.log("\uD83D\uDCCA [getProjectById] Raw query result:",{data:c,error:s}),s){if(console.error("❌ [getProjectById] Database error detected!"),console.error("Error object keys:",Object.keys(s||{})),console.error("Error message:",(null==s?void 0:s.message)||"No message"),console.error("Error code:",(null==s?void 0:s.code)||"No code"),console.error("Error details:",(null==s?void 0:s.details)||"No details"),console.error("Error hint:",(null==s?void 0:s.hint)||"No hint"),console.error("Raw error:",s),console.error("Stringified error:",JSON.stringify(s,null,2)),"PGRST116"===s.code)return console.log("❌ [getProjectById] No rows returned (PGRST116) - Project not found or access denied"),null;let o={timestamp:new Date().toISOString(),function:"getProjectById",projectId:e,userId:null==r?void 0:r.id,message:(null==s?void 0:s.message)||"Unknown error",code:(null==s?void 0:s.code)||"Unknown code",details:(null==s?void 0:s.details)||"No details available",hint:(null==s?void 0:s.hint)||"No hint available",full_error:s,error_type:typeof s,error_constructor:null==s||null==(t=s.constructor)?void 0:t.name};throw console.error("❌ [getProjectById] DETAILED ERROR INFO:",o),s}console.log("✅ [getProjectById] Project found, transforming data...");let d={id:c.id,user_id:c.user_id,name:c.name,description:c.description||"",project_type:c.project_type,location:c.location,address:c.address||"",city:"",region:"",district:"",country:"",status:c.status,priority:"medium",start_date:c.start_date,expected_completion_date:void 0,actual_completion_date:void 0,budget:c.budget||0,actual_cost:0,currency:"SAR",progress_percentage:0,is_active:c.is_active,created_at:c.created_at,updated_at:c.updated_at,location_lat:void 0,location_lng:void 0,rooms_count:void 0,bathrooms_count:void 0,floors_count:void 0,plot_area:void 0,building_area:void 0,metadata:void 0,image_url:void 0};return console.log("✅ [getProjectById] Returning transformed project:",d),d}catch(e){throw console.error("❌ [getProjectById] UNEXPECTED ERROR CAUGHT!"),console.error("Error type:",typeof e),console.error("Error constructor:",null==e||null==(r=e.constructor)?void 0:r.name),console.error("Error keys:",Object.keys(e||{})),console.error("Error message:",(null==e?void 0:e.message)||"No message available"),console.error("Error name:",(null==e?void 0:e.name)||"No name available"),console.error("Error stack:",(null==e?void 0:e.stack)||"No stack available"),console.error("Raw error object:",e),console.error("Stringified error:",JSON.stringify(e,null,2)),console.error("❌ [getProjectById] DETAILED CATCH ERROR:",{timestamp:new Date().toISOString(),function:"getProjectById_catch",error_info:{message:null==e?void 0:e.message,name:null==e?void 0:e.name,stack:null==e?void 0:e.stack,type:typeof e,constructor:null==e||null==(o=e.constructor)?void 0:o.name,keys:Object.keys(e||{})},full_error:e}),e}}},6695:(e,t,r)=>{r.d(t,{Z:()=>a});var o=r(5155);function a(e){let{children:t,className:r="",...a}=e;return(0,o.jsx)("div",{className:"card ".concat(r),...a,children:t})}r(2115)},6733:(e,t,r)=>{r.d(t,{s:()=>o});async function o(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0],{id:"dummy-user",email:"dummy@example.com"}}},9503:(e,t,r)=>{r.d(t,{k:()=>a});var o=r(5155);function a(e){let{size:t="md"}=e;return(0,o.jsxs)("svg",{className:"animate-spin text-blue-500 ".concat("sm"===t?"w-4 h-4":"lg"===t?"w-10 h-10":"w-6 h-6"),fill:"none",viewBox:"0 0 24 24",children:[(0,o.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,o.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]})}r(2115)}}]);