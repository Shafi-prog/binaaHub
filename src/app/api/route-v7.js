(()=>{var t={};t.id=8971,t.ids=[8971],t.modules={3295:t=>{"use strict";t.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},85969:(t,e,i)=>{"use strict";i.r(e),i.d(e,{patchFetch:()=>h,routeModule:()=>l,serverHooks:()=>m,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>d});var r={};i.r(r),i.d(r,{POST:()=>c});var a=i(96559),n=i(48088),s=i(37719),u=i(32190);let o={baseCosts:{foundation:180,structure:320,walls:150,roofing:200,electrical:80,plumbing:120,finishing:250},materials:{concrete:{price:450,unit:"m\xb3"},steel:{price:3.2,unit:"kg"},bricks:{price:.45,unit:"piece"},cement:{price:15,unit:"bag"},sand:{price:35,unit:"m\xb3"},tiles:{price:25,unit:"m\xb2"},paint:{price:8,unit:"liter"},doors:{price:800,unit:"piece"},windows:{price:600,unit:"piece"},electrical_points:{price:150,unit:"point"},plumbing_fixtures:{price:1200,unit:"fixture"}},labor:{mason:200,carpenter:220,electrician:250,plumber:240,painter:180,helper:120},locationMultipliers:{الرياض:1,جدة:1.05,الدمام:.95,"مكة المكرمة":1.03,"المدينة المنورة":.98,الطائف:.92,تبوك:.88,أبها:.85},finishMultipliers:{basic:.8,standard:1,premium:1.4,luxury:1.8,super_luxury:2.5}};async function c(t){try{let{extractedData:e,location:i,finishLevel:r}=await t.json();if(!e||!e.totalArea)return u.NextResponse.json({error:"بيانات المخطط المستخرجة غير صالحة"},{status:400});let a=o.locationMultipliers[i]||1,n=o.finishMultipliers[r]||1,s=function(t){let{totalArea:e,quantities:i,dimensions:r}=t,a=r.floors||1,n=[{name:"خرسانة مسلحة",quantity:Math.round(.3*e*a),unit:"m\xb3",unitPrice:o.materials.concrete.price,totalPrice:0},{name:"حديد التسليح",quantity:Math.round(25*e*a),unit:"kg",unitPrice:o.materials.steel.price,totalPrice:0},{name:"طوب أحمر",quantity:Math.round(65*i.walls),unit:"piece",unitPrice:o.materials.bricks.price,totalPrice:0},{name:"أكياس الأسمنت",quantity:Math.round(2.5*e),unit:"bag",unitPrice:o.materials.cement.price,totalPrice:0},{name:"رمل",quantity:Math.round(.4*e),unit:"m\xb3",unitPrice:o.materials.sand.price,totalPrice:0},{name:"بلاط السيراميك",quantity:Math.round(1.1*e),unit:"m\xb2",unitPrice:o.materials.tiles.price,totalPrice:0},{name:"دهان",quantity:Math.round(.5*e),unit:"liter",unitPrice:o.materials.paint.price,totalPrice:0},{name:"أبواب",quantity:i.doors,unit:"piece",unitPrice:o.materials.doors.price,totalPrice:0},{name:"نوافذ",quantity:i.windows,unit:"piece",unitPrice:o.materials.windows.price,totalPrice:0},{name:"نقاط كهربائية",quantity:i.electricalPoints,unit:"point",unitPrice:o.materials.electrical_points.price,totalPrice:0},{name:"تجهيزات السباكة",quantity:i.plumbingFixtures,unit:"fixture",unitPrice:o.materials.plumbing_fixtures.price,totalPrice:0}];return n.forEach(t=>{t.totalPrice=t.quantity*t.unitPrice}),n}(e),{totalArea:c}=e,l={foundation:Math.round(c*o.baseCosts.foundation*a),structure:Math.round(c*o.baseCosts.structure*a),walls:Math.round(c*o.baseCosts.walls*a),roofing:Math.round(c*o.baseCosts.roofing*a),electrical:Math.round(c*o.baseCosts.electrical*a),plumbing:Math.round(c*o.baseCosts.plumbing*a),finishing:Math.round(c*o.baseCosts.finishing*n*a),labor:0},p=function(t,e){let i=Math.ceil(e/10);return{mason:3*i*o.labor.mason,carpenter:2*i*o.labor.carpenter,electrician:1.5*i*o.labor.electrician,plumber:1.5*i*o.labor.plumber,painter:i*o.labor.painter,helper:4*i*o.labor.helper}}(0,c);l.labor=Object.values(p).reduce((t,e)=>t+e,0);let d=s.reduce((t,e)=>t+e.totalPrice,0),m=Object.values(l).reduce((t,e)=>t+e,0),h=Math.round((d+m)*a*n),b=function(t,e=1){let i=Math.max(3,Math.ceil(t/50)*e),r=[{name:"الأساسات والحفر",duration:Math.ceil(.15*i),cost:0},{name:"الهيكل الإنشائي",duration:Math.ceil(.25*i),cost:0},{name:"الجدران والسقف",duration:Math.ceil(.2*i),cost:0},{name:"الكهرباء والسباكة",duration:Math.ceil(.15*i),cost:0},{name:"التشطيبات الداخلية",duration:Math.ceil(.15*i),cost:0},{name:"التشطيبات الخارجية",duration:Math.ceil(.1*i),cost:0}];return{estimated_duration:i,phases:r}}(c),M=[.15,.25,.2,.15,.15,.1];b.phases.forEach((t,e)=>{t.cost=Math.round(h*M[e])});let P=function(t,e){let i=[];return t.confidence<85&&i.push("دقة استخراج البيانات أقل من 85%. يُنصح بمراجعة البيانات المستخرجة يدوياً."),t.totalArea>200&&i.push("المساحة كبيرة. فكر في تقسيم المشروع إلى مراحل لتوزيع التكاليف."),t.quantities.electricalPoints/t.totalArea<.2&&i.push("عدد النقاط الكهربائية قليل نسبياً. فكر في إضافة المزيد من المنافذ."),i.push("احصل على عروض أسعار من 3 مقاولين على الأقل للمقارنة."),i.push("اطلب ضمانات على المواد والعمالة لمدة لا تقل عن سنتين."),i.push("تأكد من حصولك على جميع التراخيص اللازمة قبل البدء."),e>5e5&&i.push("التكلفة مرتفعة. فكر في مراجعة المواصفات أو البحث عن بدائل أقل تكلفة."),i}(e,h),f=function(t,e){let i=[];return i.push({description:"استخدام الطوب الإسمنتي بدلاً من الطوب الأحمر",savings:Math.round(.08*e),impact:"توفير في التكلفة مع الحفاظ على الجودة"}),i.push({description:"استخدام الدهانات المحلية بدلاً من المستوردة",savings:Math.round(.03*e),impact:"توفير بسيط مع جودة مقبولة"}),i.push({description:"تنفيذ المشروع على مراحل متعددة",savings:Math.round(.05*e),impact:"تقليل الضغط المالي وتحسين إدارة التدفق النقدي"}),i}(0,h),g={totalCost:h,breakdown:l,materials:s,timeline:b,recommendations:P,alternatives:f,locationMultiplier:a,finishMultiplier:n,calculationDate:new Date().toISOString(),disclaimer:"التكاليف تقديرية وقد تختلف حسب ظروف السوق والمقاول المختار"};return u.NextResponse.json({success:!0,message:"تم حساب التكاليف بنجاح",estimate:g,timestamp:new Date().toISOString()})}catch(t){return u.NextResponse.json({error:"حدث خطأ أثناء حساب التكاليف",details:t instanceof Error?t.message:"خطأ غير معروف"},{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/ai/calculate-blueprint-cost/route",pathname:"/api/ai/calculate-blueprint-cost",filename:"route",bundlePath:"app/api/ai/calculate-blueprint-cost/route"},resolvedPagePath:"C:\\Users\\hp\\BinnaCodes\\binna\\src\\app\\api\\ai\\calculate-blueprint-cost\\route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:p,workUnitAsyncStorage:d,serverHooks:m}=l;function h(){return(0,s.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:d})}},96487:()=>{}};var e=require("../../../../webpack-runtime.js");e.C(t);var i=t=>e(e.s=t),r=e.X(0,[4243,580],()=>i(85969));module.exports=r})();