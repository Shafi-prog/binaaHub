(()=>{var t={};t.id=5371,t.ids=[5371],t.modules={3295:t=>{"use strict";t.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:t=>{"use strict";t.exports=require("punycode")},27910:t=>{"use strict";t.exports=require("stream")},29294:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:t=>{"use strict";t.exports=require("tls")},39727:()=>{},44870:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},47990:()=>{},51906:t=>{function e(t){var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=()=>[],e.resolve=e,e.id=51906,t.exports=e},55511:t=>{"use strict";t.exports=require("crypto")},55591:t=>{"use strict";t.exports=require("https")},63033:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:t=>{"use strict";t.exports=require("zlib")},78335:()=>{},79428:t=>{"use strict";t.exports=require("buffer")},79551:t=>{"use strict";t.exports=require("url")},81630:t=>{"use strict";t.exports=require("http")},91645:t=>{"use strict";t.exports=require("net")},94735:t=>{"use strict";t.exports=require("events")},96487:()=>{},98267:(t,e,r)=>{"use strict";r.r(e),r.d(e,{patchFetch:()=>g,routeModule:()=>d,serverHooks:()=>h,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>y});var s={};r.r(s),r.d(s,{GET:()=>c,PATCH:()=>l,POST:()=>p});var a=r(96559),o=r(48088),n=r(37719),i=r(32190),u=r(98350);async function c(t){try{let{searchParams:e}=new URL(t.url),r=e.get("storeId"),s=e.get("search"),a=e.get("customerGroup"),o=e.get("territory"),n=parseInt(e.get("limit")||"50"),c=parseInt(e.get("offset")||"0");if(!r)return i.NextResponse.json({error:"Store ID is required"},{status:400});let p=await u.V.getCustomers({search:s,customer_group:a,territory:o,disabled:!1});return i.NextResponse.json({success:!0,data:p,pagination:{limit:n,offset:c,hasMore:p.length===n}})}catch(t){return i.NextResponse.json({success:!1,error:"Failed to fetch customers",details:t instanceof Error?t.message:"Unknown error"},{status:500})}}async function p(t){try{let{storeId:e,...r}=await t.json();if(!e)return i.NextResponse.json({error:"Store ID is required"},{status:400});if(!r.customer_name)return i.NextResponse.json({error:"Customer name is required"},{status:400});let s=await u.V.createCustomer({...r,store_id:e});return i.NextResponse.json({success:!0,data:s,message:"Customer created successfully"})}catch(t){return i.NextResponse.json({success:!1,error:"Failed to create customer",details:t instanceof Error?t.message:"Unknown error"},{status:500})}}async function l(t){try{let{id:e,storeId:r,...s}=await t.json();if(!e||!r)return i.NextResponse.json({error:"Customer ID and Store ID are required"},{status:400});let a=await u.V.updateCustomer(e,s);return i.NextResponse.json({success:!0,data:a,message:"Customer updated successfully"})}catch(t){return i.NextResponse.json({success:!1,error:"Failed to update customer",details:t instanceof Error?t.message:"Unknown error"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/erp/customers/route",pathname:"/api/erp/customers",filename:"route",bundlePath:"app/api/erp/customers/route"},resolvedPagePath:"C:\\Users\\hp\\BinnaCodes\\binna\\src\\app\\api\\erp\\customers\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:m,workUnitAsyncStorage:y,serverHooks:h}=d;function g(){return(0,n.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:y})}},98350:(t,e,r)=>{"use strict";r.d(e,{V:()=>o});let s=(0,r(61223).createClientComponentClient)();class a{constructor(){this.baseUrl=process.env.NEXT_PUBLIC_ERP_API_URL||"http://localhost:8000",this.apiKey=process.env.ERP_API_KEY}async makeRequest(t,e={}){let r=`${this.baseUrl}${t}`,s={"Content-Type":"application/json",...this.apiKey&&{Authorization:`Bearer ${this.apiKey}`},...e.headers};try{let t=await fetch(r,{...e,headers:s});if(!t.ok)throw Error(`ERP API error! status: ${t.status}`);return await t.json()}catch(r){return this.fallbackToSupabase(t,e)}}async fallbackToSupabase(t,e){return null}async getCustomers(t=50,e=0){try{return await this.makeRequest(`/api/customers?limit=${t}&offset=${e}`)||{customers:[],total:0}}catch(t){return{customers:[],total:0}}}async getCustomer(t){try{let e=await this.makeRequest(`/api/customers/${t}`);return e?.customer||null}catch(t){return null}}async createCustomer(t){try{let e=await this.makeRequest("/api/customers",{method:"POST",body:JSON.stringify(t)});return e?.customer||null}catch(t){return null}}async updateCustomer(t,e){try{let r=await this.makeRequest(`/api/customers/${t}`,{method:"PUT",body:JSON.stringify(e)});return r?.customer||null}catch(t){return null}}async getProducts(t=50,e=0){try{return await this.makeRequest(`/api/products?limit=${t}&offset=${e}`)||{products:[],total:0}}catch(t){return{products:[],total:0}}}async getProduct(t){try{let e=await this.makeRequest(`/api/products/${t}`);return e?.product||null}catch(t){return null}}async updateProductStock(t,e){try{return await this.makeRequest(`/api/products/${t}/stock`,{method:"PUT",body:JSON.stringify({quantity:e})}),!0}catch(t){return!1}}async getInvoices(t=50,e=0){try{return await this.makeRequest(`/api/invoices?limit=${t}&offset=${e}`)||{invoices:[],total:0}}catch(t){return{invoices:[],total:0}}}async getInvoice(t){try{let e=await this.makeRequest(`/api/invoices/${t}`);return e?.invoice||null}catch(t){return null}}async createInvoice(t){try{let e=await this.makeRequest("/api/invoices",{method:"POST",body:JSON.stringify(t)});return e?.invoice||null}catch(t){return null}}async updateInvoiceStatus(t,e){try{return await this.makeRequest(`/api/invoices/${t}/status`,{method:"PUT",body:JSON.stringify({status:e})}),!0}catch(t){return!1}}async getAnalytics(){try{let t=await this.makeRequest("/api/analytics");return t?.analytics||this.getMockAnalytics()}catch(t){return this.getMockAnalytics()}}getMockAnalytics(){return{revenue:{total:125e3,monthly:[{month:"2024-01",amount:45e3},{month:"2024-02",amount:38e3},{month:"2024-03",amount:42e3}],growth_rate:12.5},customers:{total:150,new_this_month:12,top_customers:[{id:"1",name:"Acme Corp",total_spent:25e3},{id:"2",name:"Tech Solutions",total_spent:18e3},{id:"3",name:"Global Industries",total_spent:15e3}]},products:{total:250,low_stock_count:15,top_selling:[{id:"1",name:"Premium Widget",quantity_sold:450},{id:"2",name:"Standard Component",quantity_sold:380},{id:"3",name:"Deluxe Package",quantity_sold:220}]},invoices:{total:89,paid:65,overdue:8,pending:16}}}async syncToSupabase(){try{let{customers:t}=await this.getCustomers(1e3);if(t.length>0){let{error:e}=await s.from("erp_customers").upsert(t.map(t=>({erp_id:t.id,name:t.name,email:t.email,phone:t.phone,company:t.company,status:t.status,sync_updated_at:new Date().toISOString()})),{onConflict:"erp_id"})}let{products:e}=await this.getProducts(1e3);if(e.length>0){let{error:t}=await s.from("erp_products").upsert(e.map(t=>({erp_id:t.id,sku:t.sku,name:t.name,category:t.category,unit_price:t.unit_price,stock_quantity:t.stock_quantity,status:t.status,sync_updated_at:new Date().toISOString()})),{onConflict:"erp_id"})}return!0}catch(t){return!1}}}let o=new a}};var e=require("../../../../webpack-runtime.js");e.C(t);var r=t=>e(e.s=t),s=e.X(0,[4243,580,9398,1223],()=>r(98267));module.exports=s})();