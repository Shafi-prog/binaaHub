(()=>{var e={};e.id=2354,e.ids=[2354],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},16779:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>g,routeModule:()=>d,serverHooks:()=>h,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>y});var s={};r.r(s),r.d(s,{GET:()=>c,PATCH:()=>p,POST:()=>l});var a=r(96559),o=r(48088),n=r(37719),i=r(32190),u=r(98350);async function c(e){try{let{searchParams:t}=new URL(e.url),r=t.get("storeId"),s=t.get("customerId"),a=t.get("status"),o=parseInt(t.get("limit")||"50"),n=parseInt(t.get("offset")||"0");if(!r)return i.NextResponse.json({error:"Store ID is required"},{status:400});let c=await u.V.getSalesOrders({store_id:r,customer_id:s,status:a});return i.NextResponse.json({success:!0,data:c,pagination:{limit:o,offset:n,hasMore:c.length===o}})}catch(e){return i.NextResponse.json({success:!1,error:"Failed to fetch sales orders",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function l(e){try{let{storeId:t,customerId:r,items:s,...a}=await e.json();if(!t||!r||!s||0===s.length)return i.NextResponse.json({error:"Store ID, Customer ID, and items are required"},{status:400});let o=await u.V.validateStockAvailability(s);if(!o.valid)return i.NextResponse.json({error:"Insufficient stock for some items",stockIssues:o.errors},{status:400});let n=await u.V.createSalesOrder({store_id:t,customer_id:r,items:s,...a});return i.NextResponse.json({success:!0,data:n,message:"Sales order created successfully"})}catch(e){return i.NextResponse.json({success:!1,error:"Failed to create sales order",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function p(e){try{let t,{id:r,action:s,...a}=await e.json();if(!r)return i.NextResponse.json({error:"Order ID is required"},{status:400});switch(s){case"submit":t=await u.V.submitSalesOrder(r);break;case"cancel":t=await u.V.cancelSalesOrder(r);break;case"deliver":t=await u.V.deliverSalesOrder(r,a.deliveryDetails);break;default:t=await u.V.updateSalesOrder(r,a)}return i.NextResponse.json({success:!0,data:t,message:`Sales order ${s||"updated"} successfully`})}catch(e){return i.NextResponse.json({success:!1,error:"Failed to update sales order",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/erp/sales-orders/route",pathname:"/api/erp/sales-orders",filename:"route",bundlePath:"app/api/erp/sales-orders/route"},resolvedPagePath:"C:\\Users\\hp\\BinnaCodes\\binna\\src\\app\\api\\erp\\sales-orders\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:m,workUnitAsyncStorage:y,serverHooks:h}=d;function g(){return(0,n.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:y})}},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},39727:()=>{},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},47990:()=>{},51906:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=51906,e.exports=t},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{},98350:(e,t,r)=>{"use strict";r.d(t,{V:()=>o});let s=(0,r(61223).createClientComponentClient)();class a{constructor(){this.baseUrl=process.env.NEXT_PUBLIC_ERP_API_URL||"http://localhost:8000",this.apiKey=process.env.ERP_API_KEY}async makeRequest(e,t={}){let r=`${this.baseUrl}${e}`,s={"Content-Type":"application/json",...this.apiKey&&{Authorization:`Bearer ${this.apiKey}`},...t.headers};try{let e=await fetch(r,{...t,headers:s});if(!e.ok)throw Error(`ERP API error! status: ${e.status}`);return await e.json()}catch(r){return this.fallbackToSupabase(e,t)}}async fallbackToSupabase(e,t){return null}async getCustomers(e=50,t=0){try{return await this.makeRequest(`/api/customers?limit=${e}&offset=${t}`)||{customers:[],total:0}}catch(e){return{customers:[],total:0}}}async getCustomer(e){try{let t=await this.makeRequest(`/api/customers/${e}`);return t?.customer||null}catch(e){return null}}async createCustomer(e){try{let t=await this.makeRequest("/api/customers",{method:"POST",body:JSON.stringify(e)});return t?.customer||null}catch(e){return null}}async updateCustomer(e,t){try{let r=await this.makeRequest(`/api/customers/${e}`,{method:"PUT",body:JSON.stringify(t)});return r?.customer||null}catch(e){return null}}async getProducts(e=50,t=0){try{return await this.makeRequest(`/api/products?limit=${e}&offset=${t}`)||{products:[],total:0}}catch(e){return{products:[],total:0}}}async getProduct(e){try{let t=await this.makeRequest(`/api/products/${e}`);return t?.product||null}catch(e){return null}}async updateProductStock(e,t){try{return await this.makeRequest(`/api/products/${e}/stock`,{method:"PUT",body:JSON.stringify({quantity:t})}),!0}catch(e){return!1}}async getInvoices(e=50,t=0){try{return await this.makeRequest(`/api/invoices?limit=${e}&offset=${t}`)||{invoices:[],total:0}}catch(e){return{invoices:[],total:0}}}async getInvoice(e){try{let t=await this.makeRequest(`/api/invoices/${e}`);return t?.invoice||null}catch(e){return null}}async createInvoice(e){try{let t=await this.makeRequest("/api/invoices",{method:"POST",body:JSON.stringify(e)});return t?.invoice||null}catch(e){return null}}async updateInvoiceStatus(e,t){try{return await this.makeRequest(`/api/invoices/${e}/status`,{method:"PUT",body:JSON.stringify({status:t})}),!0}catch(e){return!1}}async getAnalytics(){try{let e=await this.makeRequest("/api/analytics");return e?.analytics||this.getMockAnalytics()}catch(e){return this.getMockAnalytics()}}getMockAnalytics(){return{revenue:{total:125e3,monthly:[{month:"2024-01",amount:45e3},{month:"2024-02",amount:38e3},{month:"2024-03",amount:42e3}],growth_rate:12.5},customers:{total:150,new_this_month:12,top_customers:[{id:"1",name:"Acme Corp",total_spent:25e3},{id:"2",name:"Tech Solutions",total_spent:18e3},{id:"3",name:"Global Industries",total_spent:15e3}]},products:{total:250,low_stock_count:15,top_selling:[{id:"1",name:"Premium Widget",quantity_sold:450},{id:"2",name:"Standard Component",quantity_sold:380},{id:"3",name:"Deluxe Package",quantity_sold:220}]},invoices:{total:89,paid:65,overdue:8,pending:16}}}async syncToSupabase(){try{let{customers:e}=await this.getCustomers(1e3);if(e.length>0){let{error:t}=await s.from("erp_customers").upsert(e.map(e=>({erp_id:e.id,name:e.name,email:e.email,phone:e.phone,company:e.company,status:e.status,sync_updated_at:new Date().toISOString()})),{onConflict:"erp_id"})}let{products:t}=await this.getProducts(1e3);if(t.length>0){let{error:e}=await s.from("erp_products").upsert(t.map(e=>({erp_id:e.id,sku:e.sku,name:e.name,category:e.category,unit_price:e.unit_price,stock_quantity:e.stock_quantity,status:e.status,sync_updated_at:new Date().toISOString()})),{onConflict:"erp_id"})}return!0}catch(e){return!1}}}let o=new a}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4243,580,9398,1223],()=>r(16779));module.exports=s})();