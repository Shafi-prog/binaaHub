(()=>{var e={};e.id=64,e.ids=[64],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},39727:()=>{},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},47990:()=>{},51906:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=51906,e.exports=t},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},71480:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>w,routeModule:()=>f,serverHooks:()=>m,workAsyncStorage:()=>h,workUnitAsyncStorage:()=>g});var s={};r.r(s),r.d(s,{DELETE:()=>x,GET:()=>c,PATCH:()=>j,POST:()=>l});var o=r(96559),a=r(48088),i=r(37719),n=r(32190),u=r(39398);let p="https://lqhopwohuddhapkhhikf.supabase.co",d="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxxaG9wd29odWRkaGFwa2hoaWtmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTY4OTI4MDYsImV4cCI6MjAzMjQ2ODgwNn0.vCxGDrVNvKA7OhwcYZLJp0mVwL_P5fJ8XDGfRp0MNio";async function c(e){try{let t=(0,u.createClient)(p,d),{data:{user:r},error:s}=await t.auth.getUser();if(s||!r)return n.NextResponse.json({error:"Unauthorized"},{status:401});let{searchParams:o}=new URL(e.url),a=o.get("userId"),i=o.get("status"),c=o.get("project_type"),l=t.from("projects").select(`
        id,
        user_id,
        name,
        description,
        project_type,
        status,
        location_lat,
        location_lng,
        address,
        city,
        region,
        district,
        country,
        start_date,
        end_date,
        budget,
        priority,
        is_active,
        image_url,
        metadata,
        created_at,
        updated_at
      `).order("created_at",{ascending:!1});l=a?l.eq("user_id",a):l.eq("user_id",r.id),i&&(l=l.eq("status",i)),c&&(l=l.eq("project_type",c));let{data:j,error:x}=await l;if(x)return n.NextResponse.json({error:"Failed to fetch projects"},{status:500});return n.NextResponse.json(j)}catch(e){return n.NextResponse.json({error:"Internal server error"},{status:500})}}async function l(e){try{let t=(0,u.createClient)(p,d),{data:{user:r},error:s}=await t.auth.getUser();if(s||!r)return n.NextResponse.json({error:"Unauthorized"},{status:401});let{name:o,description:a,project_type:i="residential",status:c="planning",location_lat:l,location_lng:j,address:x,city:f,region:h,district:g,country:m="Saudi Arabia",start_date:w,end_date:R,budget:q,priority:_="medium",image_url:N,metadata:y}=await e.json();if(!o)return n.NextResponse.json({error:"Missing required field: name"},{status:400});let{data:I,error:v}=await t.from("projects").insert({user_id:r.id,name:o,description:a,project_type:i,status:c,location_lat:l,location_lng:j,address:x,city:f,region:h,district:g,country:m,start_date:w,end_date:R,budget:q,priority:_,is_active:!0,image_url:N,metadata:y}).select().single();if(v)return n.NextResponse.json({error:"Failed to create project"},{status:500});return n.NextResponse.json(I,{status:201})}catch(e){return n.NextResponse.json({error:"Internal server error"},{status:500})}}async function j(e){try{let t=(0,u.createClient)(p,d),{data:{user:r},error:s}=await t.auth.getUser();if(s||!r)return n.NextResponse.json({error:"Unauthorized"},{status:401});let{id:o,...a}=await e.json();if(!o)return n.NextResponse.json({error:"Project ID is required"},{status:400});let{data:i,error:c}=await t.from("projects").select("user_id").eq("id",o).single();if(c||!i||i.user_id!==r.id)return n.NextResponse.json({error:"Project not found or access denied"},{status:404});let{data:l,error:j}=await t.from("projects").update({...a,updated_at:new Date().toISOString()}).eq("id",o).select().single();if(j)return n.NextResponse.json({error:"Failed to update project"},{status:500});return n.NextResponse.json(l)}catch(e){return n.NextResponse.json({error:"Internal server error"},{status:500})}}async function x(e){try{let t=(0,u.createClient)(p,d),{data:{user:r},error:s}=await t.auth.getUser();if(s||!r)return n.NextResponse.json({error:"Unauthorized"},{status:401});let{searchParams:o}=new URL(e.url),a=o.get("id");if(!a)return n.NextResponse.json({error:"Project ID is required"},{status:400});let{data:i,error:c}=await t.from("projects").select("user_id").eq("id",a).single();if(c||!i||i.user_id!==r.id)return n.NextResponse.json({error:"Project not found or access denied"},{status:404});let{error:l}=await t.from("projects").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",a);if(l)return n.NextResponse.json({error:"Failed to delete project"},{status:500});return n.NextResponse.json({message:"Project deleted successfully"})}catch(e){return n.NextResponse.json({error:"Internal server error"},{status:500})}}let f=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/projects/route",pathname:"/api/projects",filename:"route",bundlePath:"app/api/projects/route"},resolvedPagePath:"C:\\Users\\hp\\BinnaCodes\\binna\\src\\app\\api\\projects\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:h,workUnitAsyncStorage:g,serverHooks:m}=f;function w(){return(0,i.patchFetch)({workAsyncStorage:h,workUnitAsyncStorage:g})}},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4243,580,9398],()=>r(71480));module.exports=s})();