(()=>{var e={};e.id=3205,e.ids=[3205],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16543:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>P,routeModule:()=>h,serverHooks:()=>f,workAsyncStorage:()=>v,workUnitAsyncStorage:()=>y});var a={};r.r(a),r.d(a,{POST:()=>d});var i=r(96559),s=r(48088),n=r(37719),u=r(32190);let o={villa:[{material:"خرسانة مسلحة",baseQuantityPerSqm:.3,basePrice:450,unit:"متر مكعب",suppliers:["شركة الخرسانة المتطورة","مصنع الرياض للخرسانة"],alternatives:[{material:"خرسانة عادية",priceReduction:80},{material:"خرسانة خفيفة",priceReduction:50}]},{material:"حديد التسليح",baseQuantityPerSqm:25,basePrice:3.2,unit:"كيلوجرام",suppliers:["حديد الراجحي","مصانع اليمامة"],alternatives:[{material:"حديد محلي",priceReduction:.5},{material:"حديد مستورد عالي الجودة",priceReduction:-.8}]},{material:"طوب أحمر",baseQuantityPerSqm:65,basePrice:.45,unit:"حبة",suppliers:["مصنع الطوب السعودي","طوب القصيم"],alternatives:[{material:"بلوك خرساني",priceReduction:.15},{material:"طوب حراري",priceReduction:-.25}]},{material:"أسمنت بورتلاند",baseQuantityPerSqm:8,basePrice:15,unit:"كيس 50 كيلو",suppliers:["أسمنت اليمامة","الشركة السعودية للأسمنت"],alternatives:[{material:"أسمنت مقاوم للكبريتات",priceReduction:-3},{material:"أسمنت سريع التصلب",priceReduction:-5}]},{material:"رمل غسيل",baseQuantityPerSqm:.5,basePrice:35,unit:"متر مكعب",suppliers:["مقالع الرياض","رمال الخرج"],alternatives:[{material:"رمل عادي",priceReduction:10},{material:"رمل مكسر",priceReduction:5}]},{material:"بلاط سيراميك",baseQuantityPerSqm:1.1,basePrice:25,unit:"متر مربع",suppliers:["سيراميكا السعودية","الجوهرة للسيراميك"],alternatives:[{material:"بلاط محلي",priceReduction:10},{material:"بورسلين مستورد",priceReduction:-15}]}],apartment:[{material:"خرسانة مسلحة",baseQuantityPerSqm:.25,basePrice:450,unit:"متر مكعب",suppliers:["شركة الخرسانة المتطورة"],alternatives:[]}],commercial:[{material:"هيكل معدني",baseQuantityPerSqm:35,basePrice:8.5,unit:"كيلوجرام",suppliers:["الحديد والصلب السعودية"],alternatives:[]}]},l={riyadh:1,jeddah:1.1,dammam:1.05,mecca:1.15,medina:1.1,other:.9},c={basic:1,standard:1.3,luxury:1.8,super_luxury:2.5},p={fast:1.25,normal:1,slow:.95};async function m(e){var t,r,a;let i,s,n;await new Promise(e=>setTimeout(e,3e3));let u=o[e.projectType]||o.villa,m=l[e.location]||1,d=c[e.finishLevel]||1,h=p[e.timeline]||1,v=u.map(t=>{let r=t.baseQuantityPerSqm*e.area*e.floors,a=t.basePrice*m*d,i=r*a,s=t.alternatives.map(e=>({material:e.material,price:(a+e.priceReduction)*r,savings:i-(a+e.priceReduction)*r})).filter(e=>e.savings>0);return{material:t.material,quantity:Math.round(100*r)/100,unit:t.unit,unitPrice:Math.round(100*a)/100,totalPrice:Math.round(100*i)/100,supplier:t.suppliers[0],alternatives:s.slice(0,2)}}),y=v.reduce((e,t)=>e+t.totalPrice,0),f=({villa:280,apartment:220,commercial:320,warehouse:180,mosque:350}[e.projectType]||250)*e.area*e.floors*m*d*h,P=(i=.05,"fast"===(t=e).timeline?i+=.08:"slow"===t.timeline&&(i-=.02),"other"===t.location&&(i+=.03),t.floors>3&&(i+=.03),t.area>500&&(i+=.02),("luxury"===t.finishLevel||"super_luxury"===t.finishLevel)&&(i+=.05),Math.min(i,.25)),x=(y+f)*(1+P),b=function(e,t,r){let a=[],i=t.reduce((e,t)=>e+(t.alternatives?.reduce((e,t)=>e+t.savings,0)||0),0);return i>5e4&&a.push(`يمكن توفير ${Math.round(i).toLocaleString()} ريال باستخدام البدائل المقترحة`),"fast"===e.timeline&&a.push("التنفيذ السريع يزيد التكلفة 25% - فكر في تمديد المدة لتوفير التكاليف"),r>.15&&a.push("مخاطر المشروع عالية - يُنصح بزيادة الميزانية الاحتياطية بنسبة 10%"),e.area>300&&a.push("للمشاريع الكبيرة: فكر في الشراء بالجملة للحصول على خصومات أفضل"),("jeddah"===e.location||"mecca"===e.location)&&a.push("أسعار المواد في هذه المنطقة أعلى بـ 10-15% - فكر في الشراء من الرياض"),"basic"===e.finishLevel&&a.push("التشطيب الأساسي قد يؤثر على قيمة العقار - فكر في الترقية للتشطيب العادي"),a.slice(0,5)}(e,v,P),R=(s=6+Math.floor((r=e).area/100)+(r.floors-1)*2,"luxury"===r.finishLevel?s+=3:"super_luxury"===r.finishLevel&&(s+=6),"fast"===r.timeline?s*=.7:"slow"===r.timeline&&(s*=1.3),`${Math.round(s)} شهر`);return{totalCost:Math.round(x),materialsBreakdown:v,laborCost:Math.round(f),riskFactor:P,confidenceScore:(n=.85,(a=e).location&&(n+=.05),a.finishLevel&&(n+=.05),a.timeline&&(n+=.03),["villa","apartment"].includes(a.projectType)&&(n+=.02),Math.min(n,.98)),recommendations:b,timelineEstimate:R,priceValidUntil:new Date(Date.now()+2592e6).toLocaleDateString("ar-SA")}}async function d(e){try{let{userId:t,projectSpecs:r,timestamp:a}=await e.json();if(!t||!r)return u.NextResponse.json({error:"بيانات المشروع غير مكتملة"},{status:400});if(!r.projectType||!r.area)return u.NextResponse.json({error:"يرجى تحديد نوع المشروع والمساحة على الأقل"},{status:400});let i=await m(r);return u.NextResponse.json({success:!0,estimate:i,message:"تم حساب التكلفة بنجاح"})}catch(e){return u.NextResponse.json({error:"فشل في حساب تكلفة البناء"},{status:500})}}let h=new i.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/ai/calculate-construction-cost/route",pathname:"/api/ai/calculate-construction-cost",filename:"route",bundlePath:"app/api/ai/calculate-construction-cost/route"},resolvedPagePath:"C:\\Users\\hp\\BinnaCodes\\binna\\src\\app\\api\\ai\\calculate-construction-cost\\route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:v,workUnitAsyncStorage:y,serverHooks:f}=h;function P(){return(0,n.patchFetch)({workAsyncStorage:v,workUnitAsyncStorage:y})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[4243,580],()=>r(16543));module.exports=a})();